def build(bld):
    if bld.env.STATIC_LIBDCP:
        obj = bld(features = 'cxx cxxstlib')
    else:
        obj = bld(features = 'cxx cxxshlib')

    obj.name = 'libdcp'
    obj.target = 'dcp'
    obj.export_includes = ['.']
    obj.uselib = 'BOOST_FILESYSTEM BOOST_SIGNALS2 OPENSSL SIGC++ LIBXML++ OPENJPEG'
    obj.use = 'libkumu-libdcp libasdcp-libdcp'
    obj.source = """
                 asset.cc
                 asset_map.cc
                 cpl_file.cc
                 dcp.cc        
                 dcp_time.cc
                 lut.cc
                 metadata.cc
                 mxf_asset.cc
                 picture_asset.cc
                 picture_frame.cc
                 pkl_file.cc
                 reel.cc
                 argb_frame.cc
                 sound_asset.cc
                 sound_frame.cc
                 subtitle_asset.cc
                 test_mode.cc
                 types.cc
                 util.cc
                 version.cc
                 xml.cc
                 """

    headers = """
              asset.h
              dcp.h
              dcp_time.h
              exceptions.h
              metadata.h
              mxf_asset.h
              picture_asset.h
              picture_frame.h
              reel.h
              argb_frame.h
              sound_asset.h
              sound_frame.h
              subtitle_asset.h
              test_mode.h
              types.h
              version.h
              xml.h
              """

    bld.install_files('${PREFIX}/include/libdcp', headers)
    if bld.env.STATIC_LIBDCP:
        bld.install_files('${PREFIX}/lib', 'libdcp.a')
